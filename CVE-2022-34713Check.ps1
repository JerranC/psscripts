Add-Type -AssemblyName System.Windows.Forms
Add-Type -AssemblyName PresentationFramework
#Check installed version date. If greater than 6/14/22, output System is not vulnerable

#variable for machine build or os version
$currentRelease = (Get-ItemProperty "HKLM:SOFTWARE\Microsoft\Windows NT\Currentversion").CurrentBuild
$currentUBR = (Get-ItemProperty "HKLM:SOFTWARE\Microsoft\Windows NT\CurrentVersion").UBR  
$currentBuild = "$($currentRelease).$($currentUBR)"

#Variable for patched or correct build or os version
$patchedBuild = @('22000.856','19044.1889','17763.107')

#logic to check if machine is vulnerable to CVE-2022-34713
if ($currentBuild -in $patchedBuild)
{
    [system.windows.messagebox]::Show("This machine is not vulnerable to CVE-2022-34713")
}

if (!($currentBuild -in $patchedBuild ))
{
    [system.windows.messagebox]::Show("The machine is vulnerable to CVE-2022-34713")
}